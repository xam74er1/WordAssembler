
var wordInCache = []

$( function() {
    $(".word").draggable(
        {
            appendTo: 'body',
            helper: 'clone'
        }
    );
    $("#dropZone").droppable({

        activeClass: 'active',
        hoverClass: 'hover',
        accept: ":not(.ui-sortable-helper)", // Reject clones generated by sortable

        drop: function(event, ui) {
            //On cree un ellment equivalle
            var $el = $('<div class="drop-item"><summary>' + ui.draggable.text() + '</summary></div>');
            //On lui ajoute un bouton pour le suprime
            $el.append($('<button type="button" class="btn btn-default btn-xs remove"><span class="pubelle">Suprime</span></button>').click(function () { $(this).parent().detach(); }));
            $(this).append($el);

            var text = ui.draggable.text();
            //On ajoute a la liste
            //Peutre le reire en obj a locase
            wordInCache.push([text,$el]);
            verifie();
        },
        over: function(event, ui) {
            $(this).css('background', 'orange');
        },
        out: function(event, ui) {
            $(this).css('background', 'cyan');
        }
    });
} );

function verifie(){
    if(wordInCache.length>=2){

        getCloseWord(wordInCache,[])

  //On netoit tout
        $("#dropZone").empty();
        wordInCache = []


    }
}

function getCloseWord(positive,negative) {
    var resultat;
    $.ajax({
        url: '/getword',
        data: {
            "positive": JSON.stringify(positive),
            "negative":JSON.stringify(negative)
        },
        cache: false,
        type: "get",
        success: function(response) {
            console.log("------")
            console.log(response)
            //cube.material.color.setHex(response)
            resultat = response;


        }
    });
    return resultat;
}

function addWord(word){

    console.log($('#wordZone:contains("'+word+'")'))
    //Si let mot n'est pas deja present
    if($('#wordZone:contains("'+word+'")').length <= 0){
        $("#wordZone").append($('<div class="word">'+word+' </div>'))
    }

}